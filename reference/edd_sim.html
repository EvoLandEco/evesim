<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate a phylogenetic tree using the eve model — edd_sim • evesim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a phylogenetic tree using the eve model — edd_sim"><meta name="description" content="The edd_sim function simulates evolutionary relatedness dependent phylogenies based on the specified parameters, given a fixed crown age.
It provides functionality to retry the simulation multiple times in case of errors, with an optional limit on the size of the result."><meta property="og:description" content="The edd_sim function simulates evolutionary relatedness dependent phylogenies based on the specified parameters, given a fixed crown age.
It provides functionality to retry the simulation multiple times in case of errors, with an optional limit on the size of the result."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evesim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate a phylogenetic tree using the eve model</h1>

      <div class="d-none name"><code>edd_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>edd_sim</code> function simulates evolutionary relatedness dependent phylogenies based on the specified parameters, given a fixed crown age.
It provides functionality to retry the simulation multiple times in case of errors, with an optional limit on the size of the result.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">edd_sim</span><span class="op">(</span></span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">age</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"ed"</span>,</span>
<span>  offset <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  size_limit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  retry <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>A numeric vector of 6 parameters for the simulation:</p><dl><dt><code>lambda_0</code></dt>
<dd><p>Intrinsic speciation rate (must be positive and larger than <code>mu_0</code>).</p></dd>

<dt><code>mu_0</code></dt>
<dd><p>Intrinsic extinction rate.</p></dd>

<dt><code>beta_N</code></dt>
<dd><p>Effect size of species richness on the speciation rate (can be any sign or zero).</p></dd>

<dt><code>beta_phi</code></dt>
<dd><p>Effect size of evolutionary relatedness on the speciation rate (can be any sign or zero).</p></dd>

<dt><code>gamma_N</code></dt>
<dd><p>Effect size of species richness on the extinction rate (can be any sign or zero).</p></dd>

<dt><code>gamma_phi</code></dt>
<dd><p>Effect size of evolutionary relatedness on the extinction rate (can be any sign or zero).</p></dd>


</dl></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>A numeric value representing the maximum crown age at which the simulation will stop.</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>A character string indicating the evolutionary relatedness measure to be used in the simulation.
Options are:</p><dl><dt><code>"pd"</code></dt>
<dd><p>Phylogenetic diversity as the evolutionary relatedness measure (a community-wise constraint on diversification).</p></dd>

<dt><code>"ed"</code></dt>
<dd><p>Evolutionary distinctiveness as a lineage-specific measure.</p></dd>

<dt><code>"nnd"</code></dt>
<dd><p>Phylogenetic distance to the nearest neighbor as a lineage-specific measure.</p></dd>


</dl></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>A character string specifying the method for applying an offset. Currently, only <code>"simtime"</code> is available,
and it can only be used when <code>metric</code> is set to <code>"pd"</code>. Defaults to <code>"none"</code>.</p></dd>


<dt id="arg-size-limit">size_limit<a class="anchor" aria-label="anchor" href="#arg-size-limit"></a></dt>
<dd><p>An integer specifying the maximum size of the simulation result. Defaults to <code>10000</code>.</p></dd>


<dt id="arg-retry">retry<a class="anchor" aria-label="anchor" href="#arg-retry"></a></dt>
<dd><p>An integer specifying the number of retry attempts in case of failure. Defaults to <code>100</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p><dl><dt>tes</dt>
<dd><p>A phylogeny with only extant lineages, or <code>NULL</code> if the simulation failed after all retry attempts.</p></dd>

<dt>tas</dt>
<dd><p>A phylogeny with all lineages, or <code>NULL</code> if the simulation failed after all retry attempts.</p></dd>

<dt>L</dt>
<dd><p>An L table recording the historical events, or <code>NULL</code> if the simulation failed after all retry attempts.</p></dd>

<dt>msg</dt>
<dd><p>A character string containing error messages (if any) accumulated over the retry attempts.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function simulates evolutionary relatedness dependent diversification based on a specified set of parameters (<code>pars</code>). The intrinsic
speciation rate (<code>lambda_0</code>) must be positive and greater than the intrinsic extinction rate (<code>mu_0</code>). The
remaining parameters, which account for the effects of species richness and evolutionary relatedness on diversification
rates, can be of any sign or zero. The simulation may be retried multiple times (up to the specified <code>retry</code> limit)
if failures occur during execution.</p>
<p>The <code>metric</code> argument allows for different ways of measuring evolutionary relatedness, with three options: phylogenetic
diversity (<code>"pd"</code>), evolutionary distinctiveness (<code>"ed"</code>), and nearest neighbor distance (<code>"nnd"</code>). When using
the phylogenetic diversity metric, an optional offset method (<code>"simtime"</code>) is available. The simulation will terminate
once the specified <code>age</code> is reached or the <code>size_limit</code> is exceeded.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Impact of Evolutionary Relatedness on Species Diversification: A New Birth-Death Model
Tianjian Qin, Luis Valente, Rampal S. Etienne
bioRxiv 2023.11.09.566365; doi: https://doi.org/10.1101/2023.11.09.566365</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example of simulation and plotting</span></span></span>
<span class="r-in"><span><span class="co"># optionally set the number of threads.</span></span></span>
<span class="r-in"><span><span class="co"># defaults to number of logical cores.</span></span></span>
<span class="r-in"><span><span class="co"># RcppParallel::setThreadOptions(numThreads = 1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.001</span>, <span class="op">-</span><span class="fl">0.001</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">edd_sim</span><span class="op">(</span>pars <span class="op">=</span> <span class="va">pars</span>, age <span class="op">=</span> <span class="fl">10</span>, metric <span class="op">=</span> <span class="st">"nnd"</span>, offset <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tianjian Qin, Hanno Hildenbrandt, Luis Valente, Rampal Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

